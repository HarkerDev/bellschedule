{"version":3,"file":"bundle.js","sources":["node_modules\\browserify\\node_modules\\browser-pack\\_prelude.js","script\\main.js","script\\dateUtil.js","script\\schedule.js","script\\nav.js","script\\options.js","script\\mobile.js"],"names":["options","require","mobile","nav","dateUtil","schedule","addEventListener","document","getElementById","style","left","scrollX","Array","prototype","diff","a","this","filter","i","indexOf","init","setDayBeginning","date","setHours","exports","getMonday","d","Date","setDate","getDay","getDate","updateUpdateInterval","setUpdateInterval","hidden","opts","hiddenUpdateInterval","hasFocus","activeUpdateInterval","inactiveUpdateInterval","seconds","clearInterval","updateScheduleID","setInterval","updateSchedule","parseRawSchedules","rawSchedules","textContent","split","schedules","x","length","shift","str","start","substring","end","push","getMonth","valueOf","getFullYear","toString","substr","setDisplayDate","time","force","getDateFromUrlParams","displayDate","warn","rows","deleteRow","week","insertRow","enableDayView","createDay","text","warning","display","innerHTML","daySchedule","getDayInfo","col","insertCell","classList","add","head","createElement","headWrapper","days","dateString","appendChild","prevEnd","index","periodName","makePeriodNameReplacements","replacements","periodTime","lastIndexOf","showPassingPeriods","passing","createPeriod","period","table","row","lunch1","lunch1Time","createSubPeriods","lunch2","lunch2Time","getDateFromString","string","hour","min","parseInt","day","id","getScheduleIndex","undefined","parent","name","startDate","endDate","periodWrapper","height","start1","end1","start2","end2","p1","lunchPassing","p2","w2","setHighlightedPeriod","now","prevDay","prevPeriods","slice","call","getElementsByClassName","prevPeriod","remove","periodLength","removeChild","cells","periods","p","Math","round","enablePeriodNotifications","currPeriods","diff1","diff2","sendNotification","notificationDuration","duration","window","notification","Notification","setTimeout","close","setTitleTitle","titles","title","floor","random","updateUrlParams","urlParams","match","pl","search","decode","s","decodeURIComponent","replace","query","location","exec","setFullYear","setMonth","viewType","viewTypes","WEEK","goPrev","DAY","updateSearch","goNext","goCurr","curr","getYear","param","history","pushState","protocol","host","pathname","hash","replaceState","setViewType","type","event","state","expandOptions","contractOptions","toggleOptions","contains","initOptions","opt","isMobile","inputs","getElementsByTagName","localStorage","updateScheduleInterval","removeItem","input","target","checked","value","createOptions","data","JSON","parse","sections","forEach","section","hasOwnProperty","platforms","createOptionSection","attachOptionActions","displayOptionsError","timeout","createOptionSectionTitle","option","createOption","tr","th","colspan","span","tddesc","tdinput","tooltip","description","defaultValue","mobileDefault","default","getElementsByName","permission","alert","requestPermission","body","scrollTo","keyCode","interceptF5","preventDefault","interceptCtrlR","ctrlKey","metaKey","setDoge","enableDoge","download","url","cb","errcb","xmlhttp","XMLHttpRequest","open","onreadystatechange","readyState","status","responseText","ontimeout","send","navigator","userAgent","vendor","opera","innerWidth","innerHeight","test","meta","content","class"],"mappings":"AAAA;AEcA,QAASqB,iBAAgBC,GACxBA,EAAKC,SAAS,EAAE,EAAE,EAAE,GAZrBC,QAAQC,UAAY,SAASC,GAC5B,GAAIJ,GAAO,GAAIK,MAAKD,EAIpB,OAHqBJ,GAAKM,QAAvBN,EAAKO,UAAU,EAAgBP,EAAKQ,UAAU,EAC/BR,EAAKQ,UAAUR,EAAKO,SAAS,GAC/CR,gBAAgBC,GACTA,GASRE,QAAQH,gBAAkBA;;ADZ1B,GAAIrB,SAAUC,QAAQ,gBAClBC,OAASD,QAAQ,eACjBE,IAAMF,QAAQ,YACdG,SAAWH,QAAQ,iBACnBI,SAAWJ,QAAQ,gBAKvBK,kBAAiB,SAAU,WAC1BC,SAASC,eAAe,UAAUC,MAAMC,KAAOC,QAAU,OAM1DC,MAAMC,UAAUC,KAAO,SAASC,GAC/B,MAAOC,MAAKC,OAAO,SAASC,GAAI,MAAOH,GAAEI,QAAQD,GAAK,KAOvDZ,iBAAiB,OAAQ,WACxBJ,OAAOkB,OAEPjB,IAAIiB,OAEJf,SAASe,OAKTpB,QAAQoB;;AKlCT,QAAS0L,YACR,GAAI/L,GAAI+P,UAAUC,WAAaD,UAAUE,QAAUtH,OAAOuH,KAC1D,OAAGvH,QAAOwH,YAAc,KAAOxH,OAAOyH,aAAe,KAAY,EAC1D,mUAAmUC,KAAKrQ,IAAM,0kDAA0kDqQ,KAAKrQ,EAAE8C,OAAO,EAAG,IAIj7DrC,QAAQJ,KAAO,WACd,GAAIlB,GAASsB,QAAQsL,SAAWA,UAChC,IAAG5M,EAAQ,CACV,GAAImR,GAAO9Q,SAAS8E,cAAc,OAClCgM,GAAK/J,KAAO,WACZ+J,EAAKC,QAAU,yDACf/Q,SAASyM,qBAAqB,QAAQ,GAAGvH,YAAY4L,GACrD9Q,SAASyM,qBAAqB,QAAQ,GAAGuE,MAAQ;;AFkCnD,QAASxH,iBACR,GAAIC,GAASzJ,SAASC,eAAe,eAAesC,YAAYC,MAAM,KACtExC,UAASC,eAAe,SAASyJ,MAAMD,EAAOf,KAAKiB,MAAMjB,KAAKkB,SAASH,EAAO9G,SAO/E,QAASkH,mBACRC,YAQA,KANA,GAAIC,GACHC,EAAK,WACLC,EAAS,qBACTC,EAAS,SAAUC,GAAK,MAAOC,oBAAmBD,EAAEE,QAAQL,EAAI,OAChEM,EAAQC,SAASN,OAAOlH,UAAU,GAE5BgH,EAAQE,EAAOO,KAAKF,IAC1BR,UAAUI,EAAOH,EAAM,KAAOG,EAAOH,EAAM,IAQ7C,QAASrG,wBACR,GAAI3C,GAAO,GAAIK,KAQf,OANG0I,WAAa,EAAE,GAAG/I,EAAK0J,YAAYX,UAAa,GAChDA,UAAa,EAAE,GAAG/I,EAAK2J,SAASZ,UAAa,EAAE,GAC/CA,UAAa,EAAE,GAAG/I,EAAKM,QAAQyI,UAAa,GAE5Ca,UAAYC,UAAUC,OAAM9J,EAAOlB,SAASqB,UAAUH,IAElDA,EAOR,QAAS+J,UACR,GAAI/J,GAAO,GAAIK,MAAKuC,YACpB5C,GAAKM,QAAQN,EAAKQ,WAAaoJ,UAAYC,UAAUG,IAAM,EAAI,IAC/D3I,eAAerB,GAEfiK,aAAajK,GAMd,QAASkK,UACR,GAAIlK,GAAO,GAAIK,MAAKuC,YACpB5C,GAAKM,QAAQN,EAAKQ,WAAaoJ,UAAYC,UAAUG,IAAM,EAAI,IAC/D3I,eAAerB,GAEfiK,aAAajK,GAMd,QAASmK,UACR,GAAInK,GAAO,GAAIK,KACfgB,gBAAerB,GAEfiK,aAAajK,GAMd,QAASiK,cAAajH,GACrB,GAAIoH,GAAO,GAAI/J,KAEZuJ,WAAYC,UAAUC,OAAMM,EAAOtL,SAASqB,UAAUiK,IAEtDpH,EAAKxC,WAAa4J,EAAK5J,WACzBuI,UAAa,EAAI/F,EAAKb,WAAW,EACjC4G,UAAa,EAAI/F,EAAKxC,kBAEfuI,WAAa,QACbA,WAAa,GAElB/F,EAAKqH,WAAaD,EAAKC,UAAWtB,UAAa,EAAI/F,EAAKX,cAAcC,WAAWC,OAAO,UAC/EwG,WAAa,CAEzB,IAAIG,GAAS,GACb,KAAI,GAAIoB,KAASvB,WAAWG,GAAUoB,EAAQ,IAAMvB,UAAUuB,GAAS,GACvEpB,GAASA,EAAOjC,MAAM,EAAE,IAExBsD,QAAQC,UAAUxH,EAAM/D,SAAS0J,MAAOa,SAASiB,SAAW,KAAOjB,SAASkB,KAAOlB,SAASmB,SAAWzB,EAASM,SAASoB,MAnJ1H,GAAI9L,UAAWH,QAAQ,iBAGnBoK,UACAa,QAWJ1J,SAAQJ,KAAO,WAEdgJ,kBAGAV,OAAOmC,QAAQM,aAAclI,wBAE7B1D,SAASC,eAAe,UAAUF,iBAAiB,QAASyJ,eAC5DxJ,SAASC,eAAe,aAAaF,iBAAiB,QAAS+K,QAC/D9K,SAASC,eAAe,cAAcF,iBAAiB,QAASkL,QAEhEjL,SAASC,eAAe,WAAWF,iBAAiB,QAAS,WAAYqC,eAAe,MAAK,KAE7FoH,iBAGDvI,QAAQ4K,YAAc,SAASC,GAC9BnB,SAAWmB,EAGZ,IAAIlB,WAAY3J,QAAQ2J,WACvBG,IAAK,MACLF,KAAM,OAQP9K,kBAAiB,WAAY,SAASgM,GACrClC,kBACAzH,eAAe2J,EAAMC,SA4CtB/K,QAAQyC,qBAAuBA;;AC1E/B,QAASuI,iBACRjM,SAASC,eAAe,WAAW0E,UAAUC,IAAI,YACjD5E,SAASC,eAAe,gBAAgBqE,UAAY,UAKrD,QAAS4H,mBACRlM,SAASC,eAAe,WAAW0E,UAAUyD,OAAO,YACpDpI,SAASC,eAAe,gBAAgBqE,UAAY,UAKrD,QAAS6H,iBACLnM,SAASC,eAAe,WAAW0E,UAAUyH,SAAS,YACxDF,kBACID,gBAQN,QAASI,eACR,GAAIC,GAAMtM,SAASC,eAAe,UAClCqM,GAAIvM,iBAAiB,YAAakM,eAClCK,EAAIvM,iBAAiB,WAAYmM,iBAE9BK,UAAUD,EAAI3H,UAAUC,IAAI,UAE/B5E,SAASC,eAAe,gBAAgBF,iBAAiB,QAASoM,cAElE,IAAIK,GAASF,EAAIG,qBAAqB,QAEnCC,cAAaC,yBAEfD,aAAa5K,qBAAqB4K,aAAaC,uBAC/CD,aAAaE,WAAW,0BAGzB,KAAI,GAAIjM,GAAE,EAAGA,EAAE6L,EAAO7J,OAAQhC,IAC9B,CACC,GAAIkM,GAAQL,EAAO7L,EAEJ,aAAZkM,EAAMf,MACRe,EAAM9M,iBAAiB,SAAU,SAASgM,GACzCtM,QAAQsM,EAAMe,OAAO/F,MAAQ2F,aAAaX,EAAMe,OAAO/F,MAAQgF,EAAMe,OAAOC,UAGhDtN,QAAQoN,EAAM9F,MAAxC2F,aAAaG,EAAM9F,MAA6B8F,EAAME,QAAoC,QAA1BL,aAAaG,EAAM9F,MAC3D2F,aAAaG,EAAM9F,MAAQ8F,EAAME,SAEzC,UAAZF,EAAMf,MACbe,EAAM9M,iBAAiB,SAAU,SAASgM,GACzCtM,QAAQsM,EAAMe,OAAO/F,MAAQN,SAASiG,aAAaX,EAAMe,OAAO/F,MAAQgF,EAAMe,OAAOE,SAGzDvN,QAAQoN,EAAM9F,MAAQN,SAAhDiG,aAAaG,EAAM9F,MAAsC8F,EAAMG,MAAQN,aAAaG,EAAM9F,MACzD2F,aAAaG,EAAM9F,MAAQ8F,EAAMG,SAGrEH,EAAM9M,iBAAiB,SAAU,SAASgM,GACzCtM,QAAQsM,EAAMe,OAAO/F,MAAQ2F,aAAaX,EAAMe,OAAO/F,MAAQgF,EAAMe,OAAOE,QAGhDvN,QAAQoN,EAAM9F,MAAxC2F,aAAaG,EAAM9F,MAA6B8F,EAAMG,MAAQN,aAAaG,EAAM9F,MACzD2F,aAAaG,EAAM9F,MAAQ8F,EAAMG,QAQ/D,QAASC,eAAcC,GAEtBC,KAAKC,MAAMF,GAAMG,SAASC,QAAQ,SAASC,KACtCA,EAAQC,eAAe,cACxBjB,UAAYgB,EAAQE,UAAU7M,QAAQ,WAAa,IAAO2L,WAC5DmB,oBAAoBH,KAItBlB,cACAsB,sBAEA7N,SAASsC,eAAe,MAAM,GAM/B,QAASwL,qBAAoBC,GAC5B/N,SAASsC,iBAGRwB,KADEiK,EACG,uCAEA,uDAOP,QAASH,qBAAoBH,GAC5BO,yBAAyBP,GACzBA,EAAQ9N,QAAQ6N,QAAQ,SAASS,KAC5BA,EAAOP,eAAe,cACrBjB,UAAYwB,EAAON,UAAU7M,QAAQ,WAAa,IAAO2L,WAC7DyB,aAAaD,KAQhB,QAASD,0BAAyBP,GACjC,GAAIU,GAAKjO,SAAS8E,cAAc,MAC5BoJ,EAAKlO,SAAS8E,cAAc,KAEhC,IADAoJ,EAAGC,QAAU,EACVZ,EAAQC,eAAe,WAAY,CACrC,GAAIY,GAAOpO,SAAS8E,cAAc,OAClCsJ,GAAK1E,MAAQ6D,EAAiB,QAC9Ba,EAAK9J,UAAYiJ,EAAQxG,KAAO,wCAChCmH,EAAGhJ,YAAYkJ,OAEfF,GAAG3L,YAAcgL,EAAQxG,IAE1BkH,GAAG/I,YAAYgJ,GACflO,SAASC,eAAe,kBAAkBiF,YAAY+I,GAMvD,QAASD,cAAaD,GACrB,GAAIE,GAAKjO,SAAS8E,cAAc,MAC5BuJ,EAASrO,SAAS8E,cAAc,MAChCwJ,EAAUtO,SAAS8E,cAAc,KACrC,IAAGiJ,EAAOP,eAAe,WAAY,CACpC,GAAIY,GAAOpO,SAAS8E,cAAc,OAClCsJ,GAAK1E,MAAQqE,EAAOQ,QACpBH,EAAK9J,UAAYyJ,EAAOS,YAAc,yCACtCH,EAAOnJ,YAAYkJ,OAEnBC,GAAO9L,YAAcwL,EAAOS,YAAc,GAE3C,IAAI3B,GAAQ7M,SAAS8E,cAAc,QACnC+H,GAAM9F,KAAOgH,EAAOhH,KACpB8F,EAAMf,KAAOiC,EAAOjC,IACpB,IAAI2C,GAAgBlC,UAAYwB,EAAOP,eAAe,iBAAoBO,EAAOW,cAAgBX,EAAOY,OACvF,WAAd9B,EAAMf,MACRe,EAAMrG,IAAM,EACZqG,EAAMG,MAAQyB,GACS,YAAd5B,EAAMf,MACZ2C,IAAc5B,EAAME,QAAU,WAElCuB,EAAQpJ,YAAY2H,GACpBoB,EAAG/I,YAAYmJ,GACfJ,EAAG/I,YAAYoJ,GACftO,SAASC,eAAe,kBAAkBiF,YAAY+I,GAMvD,QAASN,uBACR7N,SAAS0B,uBACTxB,SAAS4O,kBAAkB,wBAAwB,GAAG7O,iBAAiB,SAAU,WAChFD,SAAS0B,yBAEVxB,SAAS4O,kBAAkB,sBAAsB,GAAG7O,iBAAiB,SAAU,WAC9ED,SAASsC,eAAe,MAAK,KAG9BpC,SAAS4O,kBAAkB,6BAA6B,GAAG7O,iBAAiB,SAAU,WACrF,GAAGN,QAAQmJ,0BAA2B,CACrC,GAAIiG,GAAaxF,aAAawF,UACzB,iBAAkB1F,QAEC,UAAd0F,EACTC,MAAM,4EACiB,WAAdD,GACTxF,aAAa0F,oBAJbD,MAAM,2DAST9O,SAASgP,KAAKrK,UAAUC,IAAInF,QAAQwE,cAAgB,MAAQ,QAC5DrE,IAAIiM,YAAYpM,QAAQwE,cAAgBrE,IAAIgL,UAAUG,IAAMnL,IAAIgL,UAAUC,MAC1E7K,SAAS4O,kBAAkB,iBAAiB,GAAG7O,iBAAiB,SAAU,WACzED,SAASsC,eAAe,MAAM,GAE9BpC,SAASgP,KAAKrK,UAAUyD,OAAO,QAC/BpI,SAASgP,KAAKrK,UAAUyD,OAAO,OAE/BxI,IAAIiM,YAAYpM,QAAQwE,cAAgBrE,IAAIgL,UAAUG,IAAMnL,IAAIgL,UAAUC,MAE1EjL,IAAIiM,YAAYpM,QAAQwE,cAAgB,MAAQ,QAEhDgL,SAAS,EAAE,KAGR1C,WACHvM,SAASD,iBAAiB,UAAW,SAASgM,GAC7C,OAAQA,EAAMmD,SACb,IAAK,KACDzP,QAAQ0P,cAEVpD,EAAMqD,iBACNtP,SAASsC,iBAEV,MACD,KAAK,IACD3C,QAAQ4P,iBAAmBtD,EAAMuD,SAASvD,EAAMwD,WAElDxD,EAAMqD,iBACNtP,SAASsC,iBAEV,MACD,KAAK,IACJ0I,QACA,MACD,KAAK,IACJG,QACA,MACD,KAAK,IACJC,YAKHsE,QAAQ/P,QAAQgQ,YAChBzP,SAAS4O,kBAAkB,cAAc,GAAG7O,iBAAiB,SAAU,SAASgM,GAC/EyD,QAAQzD,EAAMe,OAAOC,YAaxB,QAAS2C,UAASC,EAAKC,EAAIC,GAC1B,GAAIC,GAAU,GAAIC,eAClBD,GAAQE,KAAK,MAAOL,GAAK,GACzBG,EAAQG,mBAAqB,WACH,GAAtBH,EAAQI,aACW,KAAlBJ,EAAQK,OACVP,EAAGE,EAAQM,cACFP,GACTA,GAAM,EAAOC,EAAQK,UAIxBL,EAAQO,UAAY,WACnBR,GAAM,EAAM,OAEbC,EAAQQ,OA3RT,GAAI3Q,QAASD,QAAQ,eACjBE,IAAMF,QAAQ,YACdI,SAAWJ,QAAQ,iBAEnB6M,SAAW5M,OAAO4M,SAGlB9M,UACJwB,SAAQxB,QAAUA,QAElBwB,QAAQJ,KAAO,WACd6O,SAAS,eAAgBzC,cAAeW;;AFiDzC,QAASpM,wBACYC,kBAAjBzB,SAAS0B,OAA0BC,KAAKC,qBACnCC,SAA4BF,KAAKG,qBAClBH,KAAKI,wBAQ7B,QAASN,mBAAkBO,GAC1BC,cAAcC,kBAEbA,iBADEF,EAAQ,EACSG,YAAY,WAE9BC,kBACY,IAAVJ,GACoB,KAOzB,QAASK,qBACR,GAAIC,GAAatC,SAASC,eAAe,aAAasC,YAAYC,MAAM,KACxEC,WAAY,GAAIpC,MAChB,IAAIqC,GAAE,CAGN,KAFAD,UAAU,GAAK,GAAIpC,OAEbiC,EAAaK,OAAO,GAGzB,GAA2B,GAAxBL,EAAa,GAAGK,OAGlBF,YAAYC,GAAK,GAAIrC,OACrBiC,EAAaM,YAGd,CAEC,GAAIC,GAAMP,EAAaM,OACvB,IAAM,GAAHF,GAAQG,EAAIjC,QAAQ,MAAM,EAK5B,IAFA,GAAIkC,GAAQ,GAAI1B,MAAKyB,EAAIE,UAAU,EAAEF,EAAIjC,QAAQ,OAC7CoC,EAAM,GAAI5B,MAAKyB,EAAIE,UAAUF,EAAIjC,QAAQ,KAAK,EAAEiC,EAAIjC,QAAQ,OACpDoC,GAAPF,EAAWA,EAAMzB,QAAQyB,EAAMvB,UAAU,GAC7CkB,UAAU,GAAGQ,KAAKH,EAAMI,WAAWC,UAAU,EAAE,IAAIL,EAAMvB,UAAU,IAAIuB,EAAMM,cAAcC,WAAWC,OAAO,IAAIT,EAAIE,UAAUF,EAAIjC,QAAQ,WAGxI6B,WAAUC,GAAGO,KAAKJ,IAQ1B,QAASU,gBAAeC,EAAMC,GAC7B,GAAI1C,GAAQyC,EAAO,GAAIpC,MAAKoC,GAAQ5D,IAAI8D,sBAIxC,IAFA7D,SAASiB,gBAAgBC,GAEtB0C,IAAUE,aAAgB5C,EAAKoC,WAAWQ,YAAYR,UAAY,CACpE,GAAIrD,GAAWE,SAASC,eAAe,WAYvC,KAVA0D,YAAc,GAAIvC,MAAKL,GAGtB6C,KADE/D,SAASqB,UAAUH,GAAQlB,SAASqB,UAAU,GAAIE,OAC/C,wHACI,IAMJtB,EAAS+D,KAAKlB,QAAQ7C,EAASgE,UAAU,GAE/C,IAAIC,GAAOjE,EAASkE,UAAU,GAE9B,IAAIrC,KAAKsC,cAQFC,UAAUH,EAAMhD,OARC,CACvBA,EAAOlB,SAASqB,UAAUH,EAC1B,KAAI,GAAII,GAAE,EAAI,EAAFA,EAAIA,IAEf+C,UAAUH,EAAMhD,GAEhBA,EAAKM,QAAQN,EAAKQ,UAAU,KAUhC,QAASqC,MAAKO,GACb,GAAIC,GAAUpE,SAASC,eAAe,UAE7BmE,GAAQlE,MAAMmE,QAApBF,EAA8B,QACJ,OAE7BC,EAAQE,UAAYH,EAMrB,QAASD,WAAUH,EAAMhD,GACxB,GAAIwD,GAAcC,WAAWzD,GAEzB0D,EAAMV,EAAKW,WAAW,GAC1BD,GAAI1D,KAAOA,EAAKoC,UAEI,GAAjBpC,EAAKmC,YAAiC,IAAhBnC,EAAKQ,WAC7BkD,EAAIE,UAAUC,IAAI,YAEnB,IAAIC,GAAO7E,SAAS8E,cAAc,MAClCD,GAAKF,UAAUC,IAAI,OACnB,IAAIG,GAAc/E,SAAS8E,cAAc,MACzCC,GAAYJ,UAAUC,IAAI,eAC1BG,EAAYT,UAAYU,KAAKjE,EAAKO,UAAY,yBAA6BiD,EAAYU,WAA2C,SAClIJ,EAAKK,YAAYH,GACjBN,EAAIS,YAAYL,EAEhB,IAAIM,GAAU,MAEd,IAAGZ,EAAYa,MAAQ,EACtB,IAAI,GAAIzE,GAAE,EAAEA,EAAE8B,UAAU8B,EAAYa,OAAOzC,OAAOhC,IAAK,CACtD,GAAIwD,GAAO1B,UAAU8B,EAAYa,OAAOzE,GACpC0E,EAAaC,2BAA2BnB,EAAKpB,UAAU,EAAEoB,EAAKvD,QAAQ,MAAQ2D,EAAYgB,cAC1FC,EAAarB,EAAKpB,UAAUoB,EAAKvD,QAAQ,KAAM,GAG/CkC,EAAQ0C,EAAWzC,UAAU,EAAEyC,EAAW5E,QAAQ,MAClDoC,EAAMwC,EAAWzC,UAAUyC,EAAWC,YAAY,KAAK,EAE3D,IAAG9D,KAAK+D,mBAAmB,CAC1B,GAAIC,GAAU3F,SAAS8E,cAAc,MACrCa,GAAQhB,UAAUC,IAAI,UACtBgB,aAAaD,EAAQ,GAAGR,EAAQrC,EAAM/B,GACtC0D,EAAIS,YAAYS,GAGjBR,EAAUnC,CAEV,IAAI6C,GAAS7F,SAAS8E,cAAc,MAGpC,IAFAe,EAAOlB,UAAUC,IAAI,UAElBS,EAAWzE,QAAQ,MAAM,EAAG,CAE9B,GAAIkF,GAAQ9F,SAAS8E,cAAc,QACnCgB,GAAMnB,UAAUC,IAAI,QACpB,IAAImB,GAAMD,EAAM9B,UAAU,IAEtBgC,EAASD,EAAIrB,WAAW,IACxBuB,EAAaT,EAAWzC,UAAU,EAAEyC,EAAW5E,QAAQ,MAE3DsF,kBACEF,EACAX,EAAWtC,UAAU,EAAEsC,EAAWzE,QAAQ,OAC1CkC,EACAmD,EAAWlD,UAAUkD,EAAWrF,QAAQ,KAAK,EAAEqF,EAAWrF,QAAQ,MAClEqF,EAAWlD,UAAUkD,EAAWrF,QAAQ,KAAK,EAAEqF,EAAWR,YAAY,MACtEzC,EACAjC,EAGF,IAAIoF,GAASJ,EAAIrB,WAAW,IACxB0B,EAAaZ,EAAWzC,UAAUyC,EAAW5E,QAAQ,MAAM,EAE/DsF,kBACEC,EACAd,EAAWtC,UAAUsC,EAAWzE,QAAQ,MAAM,GAC9CkC,EACAsD,EAAWrD,UAAUqD,EAAWxF,QAAQ,KAAK,EAAEwF,EAAWxF,QAAQ,MAClEwF,EAAWrD,UAAUqD,EAAWxF,QAAQ,KAAK,EAAEwF,EAAWX,YAAY,MACtEzC,EACAjC,GAGF8E,EAAOX,YAAYY,OAEfF,cAAaC,EAAOR,EAAWvC,EAAME,EAAIjC,EAC9C0D,GAAIS,YAAYW,IAUnB,QAASP,4BAA2BD,EAAYE,GAC/C,GAAGA,EAAa5C,OAAS,EACxB,IAAI,GAAIhC,GAAE,EAAEA,EAAE4E,EAAa5C,OAAOhC,IACjC,IAAI4E,EAAa5E,GAAGC,QAAQyE,GAC3B,MAAOE,GAAa5E,GAAGoC,UAAUwC,EAAa5E,GAAGC,QAAQ,MAAM,EAGlE,OAAOyE,GASR,QAASgB,mBAAkBC,EAAQvF,GAClC,GAAIwF,GAAOD,EAAOvD,UAAU,EAAEuD,EAAO1F,QAAQ,MACzC4F,EAAMF,EAAOvD,UAAUuD,EAAO1F,QAAQ,KAAK,EAE/C,OADQ,GAAL2F,IAAQA,EAAOE,SAASF,EAAK,IAAI,IAC7B,GAAInF,MAAKL,EAAKqC,cAAcrC,EAAKmC,WAAWnC,EAAKQ,UAAUgF,EAAKC,GAOxE,QAAShC,YAAWkC,GAOnB,IAAI,GAJAC,GAFA1B,EAAayB,EAAIxD,WAAWC,UAAU,EAAI,IAAMuD,EAAInF,UAAU4B,UAAY,IAAMuD,EAAItD,cAAcC,WAAWC,OAAO,IAGpH8B,EAAQ,EACRG,KAEI5E,EAAE,EAAEA,EAAE8B,UAAU,GAAGE,OAAOhC,IAC7B8B,UAAU,GAAG9B,GAAGC,QAAQqE,KAExBxC,UAAU,GAAG9B,GAAGC,QAAQ,MAAQ,GAElC+F,EAAKlE,UAAU,GAAG9B,GAAGoC,UAAUN,UAAU,GAAG9B,GAAGC,QAAQ,KAAM,EAAE6B,UAAU,GAAG9B,GAAGC,QAAQ,KAAK,GAC5F2E,EAAe9C,UAAU,GAAG9B,GAAGoC,UAAUN,UAAU,GAAG9B,GAAGC,QAAQ,KAAK,EAAE6B,UAAU,GAAG9B,GAAGC,QAAQ,MAAM4B,MAAM,MAG5GmE,EAAKlE,UAAU,GAAG9B,GAAGoC,UAAUN,UAAU,GAAG9B,GAAGC,QAAQ,KAAM,GAG9DwE,EAAQwB,iBAAiBD,GAS3B,OANUE,UAAPF,IACFA,EAAKD,EAAIpF,SACU8D,EAAZ,GAAJuB,GAAa,GAAJA,EAAeA,EAAK,EACnBA,IAGLvB,MAASA,EAAOuB,GAAMA,EAAI1B,WAAcA,EAAYM,aAAgBA,GAM9E,QAASqB,kBAAiBD,GACzB,GAAO,GAAJA,EAAO,MAAO,EACjB,KAAI,GAAIhG,GAAE,EAAEA,EAAE8B,UAAUE,OAAOhC,IAC9B,GAAGgG,GAAIlE,UAAU9B,GAAG,GAAI,MAAOA,EAEhC,OAAO,GAOR,QAASiF,cAAakB,EAAQC,EAAMjE,EAAOE,EAAKjC,GAC/CiG,UAAYX,kBAAkBvD,EAAM/B,GACpCkG,QAAUZ,kBAAkBrD,EAAIjC,EAEhC,IAAImG,GAAgBlH,SAAS8E,cAAc,MAC3CoC,GAAcvC,UAAUC,IAAI,iBAC5BsC,EAAc7B,WAAa0B,EAC3BG,EAAcpE,MAAQkE,UACtBE,EAAclE,IAAMiE,OAEpB,IAAItE,IAAUsE,QAAQD,WAAW,GAEjC,OAAGrE,GAAS,GACXuE,EAAchH,MAAMiH,OAAUxE,EAAO,EAAK,KAEvCA,GAAU,KACToE,IAAMG,EAAc5C,UAAYyC,GAAe,GAAPpE,EAAY,IAAM,UAAYG,EAAQ,MAAQE,GACtFL,EAAO,KAAOoE,EAAKnG,QAAQ,MAC7BsG,EAAcvC,UAAUC,IAAI,SAGxBkC,EAAO5B,YAAYgC,IAT1B,OAgBD,QAAShB,kBAAiBY,EAAQC,EAAMK,EAAQC,EAAMC,EAAQC,EAAMxG,GACnE,GAAIyG,GAAKxH,SAAS8E,cAAc,MAUhC,IATA0C,EAAG7C,UAAUC,IAAI,UACjBgB,aACE4B,EACAT,EAAKhE,UAAU,EAAEgE,EAAKnG,QAAQ,MAC9BwG,EACAC,EACAtG,GACF+F,EAAO5B,YAAYsC,GAEhB7F,KAAK+D,mBAAoB,CAC3B,GAAI+B,GAAezH,SAAS8E,cAAc,MAC1C2C,GAAa9C,UAAUC,IAAI,UAC3BgB,aAAa6B,EAAa,GAAGJ,EAAKC,EAAOvG,GACzC+F,EAAO5B,YAAYuC,GAGpB,GAAIC,GAAK1H,SAAS8E,cAAc,MAChC4C,GAAG/C,UAAUC,IAAI,SACjB,IAAI+C,GAAK3H,SAAS8E,cAAc,MAChC6C,GAAGhD,UAAUC,IAAI,iBACjBgB,aACE8B,EACAX,EAAKhE,UAAUgE,EAAKnG,QAAQ,KAAK,GACjC0G,EACAC,EACAxG,GACF+F,EAAO5B,YAAYwC,GAMpB,QAASE,sBAAqBpE,GAEzBA,IAAMA,EAAOpC,KAAKyG,MAGtB,IAAI9G,GAAO,GAAIK,MAAKoC,EACpBzC,GAAKC,SAAS,EAAE,EAAE,EAAE,EAIpB,IAAI8G,GAAU9H,SAASC,eAAe,SAClC8H,IACJ,IAAGD,EAAQ,CAEVC,EAAc1H,MAAMC,UAAU0H,MAAMC,KAAKH,EAAQI,uBAAuB,OAExE,KAAI,GAAIvH,GAAEoH,EAAYpF,OAAO,EAAEhC,GAAG,EAAEA,IAAI,CACvC,GAAIwH,GAAaJ,EAAYpH,EAC7BwH,GAAWxD,UAAUyD,OAAO,MAE5B,IAAIC,GAAeF,EAAWD,uBAAuB,gBAAgB,EAClEG,IAAcF,EAAWG,YAAYD,GAKzCP,EAAQnB,GAAK,GAKd,IAAI,GADA3B,GAAOhF,SAASC,eAAe,YAAY4D,KAAK,GAAG0E,MAC/CpH,EAAE,EAAEA,EAAE6D,EAAKrC,OAAOxB,IAAI,CAC7B,GAAIuF,GAAM1B,EAAK7D,EACf,IAAGJ,EAAKoC,WAAauD,EAAI3F,KAAK,CAE7B2F,EAAIC,GAAK,OAIT,KAAI,GADA6B,GAAU9B,EAAIwB,uBAAuB,iBACjCO,EAAE,EAAEA,EAAED,EAAQ7F,OAAO8F,IAAI,CAChC,GAAI5C,GAAS2C,EAAQC,EACrB,IAAGjF,EAAKqC,EAAO/C,OAAO,GAAKU,EAAKqC,EAAO7C,IAAI,IAC1C6C,EAAOlB,UAAUC,IAAI,QAEjBiB,EAAO7C,IAAI6C,EAAO/C,OAAO,KAAO,IAAG,CACtC,GAAIH,IAAUkD,EAAO7C,IAAMQ,GAAQ,GACnCqC,GAAOvB,WAAa,8BACjB3B,EAAO,EACP+F,KAAKC,MAAMhG,GAAU,mBACrB+F,KAAKC,MAAa,GAAPhG,GAAa,uBAOhC,GAAGhB,KAAKiH,0BAA2B,CAMlC,IAAI,GALAC,GAAcxI,MAAMC,UAAU0H,MAAMC,KAAKjI,SAASkI,uBAAuB,QAEzEY,EAAQD,EAAYtI,KAAKwH,GACzBgB,EAAQhB,EAAYxH,KAAKsI,GAErBlI,EAAE,EAAGA,EAAEmI,EAAMnG,OAAQhC,IAAK,CACjC,GAAIoG,GAAO8B,EAAYlI,GAAG0E,UACvB0B,KAASlF,UAAUmH,iBAAiBjC,EAAO,gBAAiBpF,KAAKsH,sBAErE,IAAI,GAAItI,GAAE,EAAGA,EAAEoI,EAAMpG,OAAQhC,IAAK,CACjC,GAAIoG,GAAOgB,EAAYpH,GAAG0E,UACvB0B,KAASlF,UAAUmH,iBAAiBjC,EAAO,cAAepF,KAAKsH,wBASrE,QAAS7G,gBAAeoB,EAAKC,GAC5BF,eAAeC,EAAKC,GACpBmE,uBAQD,QAASoB,kBAAiB7E,EAAM+E,GAC/B,GAAG,gBAAkBC,QAAQ,CAC5B,GAAIC,GAAe,GAAIC,cAAalF,EACjC+E,GAAW,GACbI,WAAW,WAAYF,EAAaG,SAAoB,IAATL,IAnelD,GAAItJ,KAAMF,QAAQ,YACdG,SAAWH,QAAQ,iBACnBD,QAAUC,QAAQ,gBAClBiC,KAKAqD,MAAQ,SAAU,SAAU,UAAW,YAAa,WAAY,SAAU,YAC1EvC,UAKAkB,YAEA9B,UAAW,EAEXK,gBAEJjB,SAAQJ,KAAO,WACdc,KAAOlC,QAAQA,QAEfO,SAASD,iBAAiB,mBAAoB,WACzCC,SAAS0B,QACZU,iBAGDZ,yBAGDzB,iBAAiB,QAAS,WACzBqC,iBAGAP,UAAW,EACXL,yBAEDzB,iBAAiB,OAAQ,WACxB8B,UAAW,EACXL,yBAIDa,qBAqBDpB,QAAQO,qBAAuBA,qBAwZ/BP,QAAQmB,eAAiBA","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/**\r\n * Primary script for the Harker Bell Schedule\r\n * Hosted at http://harkerdev.github.io/bellschedule\r\n**/\r\n\r\nvar options = require(\"./options.js\");\r\nvar mobile = require(\"./mobile.js\");\r\nvar nav = require(\"./nav.js\");\r\nvar dateUtil = require(\"./dateUtil.js\");\r\nvar schedule = require(\"./schedule.js\");\r\n\r\n/**\r\n * CSS things\r\n */\r\naddEventListener(\"scroll\", function(event) {\r\n\tdocument.getElementById(\"header\").style.left = scrollX + \"px\";\r\n});\r\n\r\n/**\r\n * Returns an array of values in the array that aren't in a.\r\n */\r\nArray.prototype.diff = function(a) {\r\n\treturn this.filter(function(i) {return a.indexOf(i) < 0;});\r\n};\r\n\r\n\r\n/**\r\n * Parses schedules, creates schedule for correct week, sets title title on page load.\r\n */\r\naddEventListener(\"load\", function(event) {\r\n\tmobile.init();\r\n\r\n\tnav.init();\r\n\r\n\tschedule.init();\r\n\r\n\t//updateSchedule();\r\n\t//updateClock();\r\n\t\r\n\toptions.init();\r\n});\r\n","/**\r\n * Returns the Monday of next week if date is Saturday; else returns the Monday of that week\r\n */\r\nexports.getMonday = function(d) {\r\n\tvar date = new Date(d);\r\n\tif(date.getDay()>=6) date.setDate(date.getDate()+2); //set date to next Monday if today is Saturday\r\n\telse date.setDate(date.getDate()-date.getDay()+1); //else set date Monday of this week\r\n\tsetDayBeginning(date); //set to beginning of day\r\n\treturn date;\r\n}\r\n\r\n/**\r\n * Sets given date to beginning of the day (12:00 AM).\r\n */\r\nfunction setDayBeginning(date) {\r\n\tdate.setHours(0,0,0,0);\r\n}\r\nexports.setDayBeginning = setDayBeginning;","var nav = require(\"./nav.js\");\r\nvar dateUtil = require(\"./dateUtil.js\");\r\nvar options = require(\"./options.js\");\r\nvar opts;\r\n\r\n/**\r\n * Constants\r\n */\r\nvar days = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"]; //days of the week in string form\r\nvar schedules; //array of schedules (each schedule is an array in this array\r\n\r\n/**\r\n * Globals\r\n */\r\nvar displayDate; //beginning of time period currently being displayed by the schedule\r\n\r\nvar hasFocus = true; //document.hasFocus() seems to be unreliable; assumes window has focus on page load\r\n\r\nvar updateScheduleID; //ID of interval of updateSchedule\r\n\r\nexports.init = function() {\r\n\topts = options.options;\r\n\t\r\n\tdocument.addEventListener(\"visibilitychange\", function(event) {\r\n\t\tif(!document.hidden) { //only slightly redundant; on un-minimize, document gains visibility without focus\r\n\t\t\tupdateSchedule();\r\n\t\t\t// updateClock();\r\n\t\t}\r\n\t\tupdateUpdateInterval();\r\n\t});\r\n\r\n\taddEventListener(\"focus\", function(event) {\r\n\t\tupdateSchedule();\r\n\t\t//updateClock();\r\n\r\n\t\thasFocus = true;\r\n\t\tupdateUpdateInterval();\r\n\t});\r\n\taddEventListener(\"blur\", function(event) {\r\n\t\thasFocus = false;\r\n\t\tupdateUpdateInterval();\r\n\t});\r\n\t\r\n\t\r\n\tparseRawSchedules();\r\n};\r\n\r\n//exports.setHiddenUpdateInterval = function(interval) {\r\n//\topts.hiddenUpdateInterval = interval;\r\n//};\r\n//exports.setActiveUpdateInterval = function(interval) {\r\n//\topts.activeUpdateInterval = interval;\r\n//};\r\n//exports.setInactiveUpdateInterval = function(interval) {\r\n//\topts.inactiveUpdateInterval = interval;\r\n//};\r\n\r\n/**\r\n * Sets the correct update interval based on the current state (focus and visibility) of the document.\r\n */\r\nfunction updateUpdateInterval() {\r\n\tif(document.hidden) setUpdateInterval(opts.hiddenUpdateInterval); //assume that hidden implies no focus\r\n\telse if(hasFocus) setUpdateInterval(opts.activeUpdateInterval);\r\n\telse setUpdateInterval(opts.inactiveUpdateInterval);\r\n}\r\nexports.updateUpdateInterval = updateUpdateInterval;\r\n\r\n/**\r\n * Updates the interval for automatically refreshing the page.\r\n * seconds is the new interval in seconds.\r\n */\r\nfunction setUpdateInterval(seconds) {\r\n\tclearInterval(updateScheduleID);\r\n\tif(seconds>0)\r\n\t\tupdateScheduleID = setInterval(function() {\r\n\t\t\t//updateClock();\r\n\t\t\tupdateSchedule();\r\n\t\t}, seconds * 1000); //convert to milliseconds\r\n\telse updateScheduleID = null;\r\n}\r\n\r\n/**\r\n * Parses raw schedule in body of page into schedule array\r\n * Code is questionable\r\n */\r\nfunction parseRawSchedules() {\r\n\tvar rawSchedules=document.getElementById(\"schedules\").textContent.split(\"\\n\"); //get raw schedule text\r\n\tschedules = new Array();\r\n\tvar x=0; //index in schedules\r\n\tschedules[0] = new Array(); //create array of special schedule days\r\n\r\n\twhile(rawSchedules.length>0)\r\n\t{\r\n\t\t//loop through all lines in raw schedule text\r\n\t\tif(rawSchedules[0].length==0)\r\n\t\t{\r\n\t\t\t//if line is empty, move to next index in schedules\r\n\t\t\tschedules[++x] = new Array(); //could probably use id as index instead, or just properties\r\n\t\t\trawSchedules.shift();\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t//if line has text, save in current location in schedules\r\n\t\t\tvar str = rawSchedules.shift();\r\n\t\t\tif(x==0 && str.indexOf(\"|\")>=0)\r\n\t\t\t{\r\n\t\t\t\t//behavior for blocks of dates with the same schedule\r\n\t\t\t\tvar start = new Date(str.substring(0,str.indexOf(\"|\")));\r\n\t\t\t\tvar end = new Date(str.substring(str.indexOf(\"|\")+1,str.indexOf(\"\\t\")));\r\n\t\t\t\tfor(;start<=end;start.setDate(start.getDate()+1)){\r\n\t\t\t\t\tschedules[0].push(start.getMonth().valueOf()+1+\"/\"+start.getDate()+\"/\"+start.getFullYear().toString().substr(-2)+str.substring(str.indexOf(\"\\t\")));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse schedules[x].push(str);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Displays schedule of the week of the given date/time\r\n */\r\nfunction setDisplayDate(time, force) {\r\n\tvar date = (time ? new Date(time) : nav.getDateFromUrlParams()); //variable to keep track of current day in loop\r\n\r\n\tdateUtil.setDayBeginning(date);\r\n\r\n\tif(force || !displayDate || (date.valueOf()!=displayDate.valueOf())) {\r\n\t\tvar schedule = document.getElementById(\"schedule\"); //get schedule table\r\n\r\n\t\tdisplayDate = new Date(date);\r\n\r\n\t\tif(dateUtil.getMonday(date) > dateUtil.getMonday(new Date()))\r\n\t\t\twarn(\"This is a future date, so the schedule may be incorrect. (In particular, special/alternate schedules may be missing.)\"); //display warning if date is in the future\r\n\t\telse warn(\"\"); //else display message\r\n\r\n\t\t/*\r\n\t\tif(date.valueOf()==dateUtil.getMonday(new Date()).valueOf()) document.getElementById(\"currWeek\").style.display = \"none\"; //hide back to current week button on current week\r\n\t\telse document.getElementById(\"currWeek\").style.display = \"inline\"; //else show the button\r\n\t\t*/\r\n\t\twhile(schedule.rows.length) schedule.deleteRow(-1); //clear existing weeks (rows); there should only be one, but just in case...\r\n\r\n\t\tvar week = schedule.insertRow(-1); //create new week (row)\r\n\r\n\t\tif(!opts.enableDayView) {\r\n\t\t\tdate = dateUtil.getMonday(date);\r\n\t\t\tfor(var d=0;d<5;d++) {\r\n\t\t\t\t//for each day Monday through Friday (inclusive)\r\n\t\t\t\tcreateDay(week, date);\r\n\r\n\t\t\t\tdate.setDate(date.getDate()+1); //increment day\r\n\t\t\t}\r\n\t\t} else createDay(week, date);\r\n\t}\r\n}\r\n\r\n\r\n/**\r\n * Displays the given warning or hides the warning div if no warning text is given.\r\n */\r\nfunction warn(text) {\r\n\tvar warning = document.getElementById(\"warning\")\r\n\t\r\n\tif(text) warning.style.display = \"block\";\r\n\telse warning.style.display = \"none\";\r\n\t\r\n\twarning.innerHTML = text;\r\n}\r\n\r\n/**\r\n * Creates the day for the given date and appends it to the given week\r\n */\r\nfunction createDay(week, date) {\r\n\tvar daySchedule = getDayInfo(date); //get schedule for that day\r\n\r\n\tvar col = week.insertCell(-1); //create cell for day\r\n\tcol.date = date.valueOf(); //store date in cell element\r\n\r\n\tif(date.getMonth()==9 && date.getDate()==31) //check Halloween\r\n\t\tcol.classList.add(\"halloween\");\r\n\r\n\tvar head = document.createElement(\"div\"); //create header div in cell\r\n\thead.classList.add(\"head\");\r\n\tvar headWrapper = document.createElement(\"div\");\r\n\theadWrapper.classList.add(\"headWrapper\");\r\n\theadWrapper.innerHTML = days[date.getDay()] + \"<div class=\\\"headDate\\\">\" + daySchedule.dateString + /*\" (\" + daySchedule.id + \")*/\"</div>\"; //Portion commented out represents schedule id of that day\r\n\thead.appendChild(headWrapper);\r\n\tcol.appendChild(head);\r\n\r\n\tvar prevEnd = \"8:00\"; //set start of day to 8:00AM\r\n\r\n\tif(daySchedule.index > 0) { //populates cell with day's schedule (a bit messily)\r\n\t\tfor(var i=1;i<schedules[daySchedule.index].length;i++) {\r\n\t\t\tvar text = schedules[daySchedule.index][i];\r\n\t\t\tvar periodName = makePeriodNameReplacements(text.substring(0,text.indexOf(\"\\t\")), daySchedule.replacements);\r\n\t\t\tvar periodTime = text.substring(text.indexOf(\"\\t\")+1);\r\n\t\t\t\r\n\r\n\t\t\tvar start = periodTime.substring(0,periodTime.indexOf(\"-\"));\r\n\t\t\tvar end = periodTime.substring(periodTime.lastIndexOf(\"-\")+1);\r\n\r\n\t\t\tif(opts.showPassingPeriods){\r\n\t\t\t\tvar passing = document.createElement(\"div\");\r\n\t\t\t\tpassing.classList.add(\"period\");\r\n\t\t\t\tcreatePeriod(passing,\"\",prevEnd,start,date);\r\n\t\t\t\tcol.appendChild(passing);\r\n\t\t\t}\r\n\r\n\t\t\tprevEnd = end;\r\n\r\n\t\t\tvar period = document.createElement(\"div\");\r\n\t\t\tperiod.classList.add(\"period\");\r\n\r\n\t\t\tif(periodName.indexOf(\"|\")>=0) {\r\n\t\t\t\t//handle split periods (i.e. lunches)\r\n\t\t\t\tvar table = document.createElement(\"table\");\r\n\t\t\t\ttable.classList.add(\"lunch\");\r\n\t\t\t\tvar row = table.insertRow(-1);\r\n\r\n\t\t\t\tvar lunch1 = row.insertCell(-1);\r\n\t\t\t\tvar lunch1Time = periodTime.substring(0,periodTime.indexOf(\"||\"));\r\n\r\n\t\t\t\tcreateSubPeriods(\r\n\t\t\t\t\t\tlunch1,\r\n\t\t\t\t\t\tperiodName.substring(0,periodName.indexOf(\"||\")),\r\n\t\t\t\t\t\tstart,\r\n\t\t\t\t\t\tlunch1Time.substring(lunch1Time.indexOf(\"-\")+1,lunch1Time.indexOf(\"|\")),\r\n\t\t\t\t\t\tlunch1Time.substring(lunch1Time.indexOf(\"|\")+1,lunch1Time.lastIndexOf(\"-\")),\r\n\t\t\t\t\t\tend,\r\n\t\t\t\t\t\tdate\r\n\t\t\t\t);\r\n\r\n\t\t\t\tvar lunch2 = row.insertCell(-1);\r\n\t\t\t\tvar lunch2Time = periodTime.substring(periodTime.indexOf(\"||\")+2);\r\n\r\n\t\t\t\tcreateSubPeriods(\r\n\t\t\t\t\t\tlunch2,\r\n\t\t\t\t\t\tperiodName.substring(periodName.indexOf(\"||\")+2),\r\n\t\t\t\t\t\tstart,\r\n\t\t\t\t\t\tlunch2Time.substring(lunch2Time.indexOf(\"-\")+1,lunch2Time.indexOf(\"|\")),\r\n\t\t\t\t\t\tlunch2Time.substring(lunch2Time.indexOf(\"|\")+1,lunch2Time.lastIndexOf(\"-\")),\r\n\t\t\t\t\t\tend,\r\n\t\t\t\t\t\tdate\r\n\t\t\t\t);\r\n\r\n\t\t\t\tperiod.appendChild(table);\r\n\t\t\t}\r\n\t\t\telse createPeriod(period,periodName,start,end,date);\r\n\t\t\tcol.appendChild(period);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Returns new name for period based on array of replacements.\r\n * If the current period name is listed in the array of replacements, returns the new, replaced name; otherwise, returns current name.\r\n * replacements is an array of strings of the form \"OldName->NewName\"\r\n */\r\nfunction makePeriodNameReplacements(periodName, replacements) {\r\n\tif(replacements.length > 0) {\r\n\t\tfor(var i=0;i<replacements.length;i++) {\r\n\t\t\tif(!replacements[i].indexOf(periodName))\r\n\t\t\t\treturn replacements[i].substring(replacements[i].indexOf(\"->\")+2);\r\n\t\t}\r\n\t}\r\n\treturn periodName;\r\n}\r\n\r\n\r\n\r\n/**\r\n * Takes in a date and a string of form \"hh:MM\" and turns it into a time on the day of the given date.\r\n * Assumes hours less than 7 are PM and hours 7 or greater are AM.\r\n */\r\nfunction getDateFromString(string, date) {\r\n\tvar hour = string.substring(0,string.indexOf(\":\"));\r\n\tvar min = string.substring(string.indexOf(\":\")+1);\r\n\tif(hour<7) hour = parseInt(hour,10)+12; //assumes hours less than seven are PM and hours 7 or greater are AM\r\n\treturn new Date(date.getFullYear(),date.getMonth(),date.getDate(),hour,min);\r\n}\r\n\r\n/**\r\n * For given day, returns index of schedule id in schedules, schedule id, and formatted date (mm/dd/yy).\r\n * Schedule id index is 0 if not found in schedules.\r\n */\r\nfunction getDayInfo(day) {\r\n\tvar dateString = day.getMonth().valueOf()+1 + \"/\" + day.getDate().valueOf() + \"/\" + day.getFullYear().toString().substr(-2); //format in mm/dd/YY\r\n\r\n\tvar id;\r\n\tvar index = 0;\r\n\tvar replacements = [];\r\n\t\r\n\tfor(var i=0;i<schedules[0].length;i++) //search for special schedule on day\r\n\t\tif(!schedules[0][i].indexOf(dateString)){\r\n\t\t\t//found special schedule\r\n\t\t\tif(schedules[0][i].indexOf(\"[\") >= 0) { //check for period replacements\r\n\t\t\t\t//cut replacements and space character out of id and save separately\r\n\t\t\t\tid = schedules[0][i].substring(schedules[0][i].indexOf(\"\\t\")+1,schedules[0][i].indexOf(\"[\")-1)\r\n\t\t\t\treplacements = schedules[0][i].substring(schedules[0][i].indexOf(\"[\")+1,schedules[0][i].indexOf(\"]\")).split(\",\");\r\n\t\t\t} else {\r\n\t\t\t\t// no replacements to be made\r\n\t\t\t\tid = schedules[0][i].substring(schedules[0][i].indexOf(\"\\t\")+1);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tindex = getScheduleIndex(id);\r\n\t\t}\r\n\t\r\n\tif(id === undefined) { //no special schedule found\r\n\t\tid = day.getDay();\r\n\t\tif(id==0 || id==6) index = id = 0; //no school on weekends\r\n\t\telse index = id; //default schedule for that day\r\n\t}\r\n\t\r\n\treturn { \"index\": index, \"id\": id, \"dateString\": dateString, \"replacements\": replacements };\r\n}\r\n\r\n/**\r\n * Gets the index in the list of schedules of the schedule with the given schedule id (or 0 if no matching schedules were found)\r\n */\r\nfunction getScheduleIndex(id) {\r\n\tif(id==0) return 0; //schedule id 0 represents no school\r\n\tfor(var i=1;i<schedules.length;i++) { //find index of schedule id\r\n\t\tif(id==schedules[i][0]) return i; //found specified schedule id\r\n\t}\r\n\treturn 0; //couldn't find specified schedule\r\n}\r\n\r\n/**\r\n * Creates and returns a new period wrapper with the given content and start/end times.\r\n * Also applies any special properties based on period length (text on single line if too short, block period if longer than regular).\r\n */\r\nfunction createPeriod(parent, name, start, end, date){\r\n\tstartDate = getDateFromString(start,date);\r\n\tendDate = getDateFromString(end,date);\r\n\r\n\tvar periodWrapper = document.createElement(\"div\");\r\n\tperiodWrapper.classList.add(\"periodWrapper\");\r\n\tperiodWrapper.periodName = name;\r\n\tperiodWrapper.start = startDate;\r\n\tperiodWrapper.end = endDate;\r\n\r\n\tvar length = (endDate-startDate)/60000;\r\n\r\n\tif(length > 0) {\r\n\t\tperiodWrapper.style.height = (length-1) + \"px\"; //minus 1 to account for 1px border\r\n\r\n\t\tif(length >= 15) {\r\n\t\t\tif(name) periodWrapper.innerHTML = name + (length<30 ? \" \" : \"<br />\") + start + \" â€“ \" + end;\r\n\t\t\tif(length>50 && !name.indexOf(\"P\")) //handle block periods (class=long, i.e. bold text)\r\n\t\t\t\tperiodWrapper.classList.add(\"long\");\r\n\t\t}\r\n\r\n\treturn parent.appendChild(periodWrapper);\r\n\t}\r\n}\r\n\r\n/**\r\n * Creates and appends two new sub-periods and passing period to parent period with given start and end times.\r\n */\r\nfunction createSubPeriods(parent, name, start1, end1, start2, end2, date) {\r\n\tvar p1 = document.createElement(\"div\");\r\n\tp1.classList.add(\"period\");\r\n\tcreatePeriod(\r\n\t\t\tp1,\r\n\t\t\tname.substring(0,name.indexOf(\"|\")),\r\n\t\t\tstart1,\r\n\t\t\tend1,\r\n\t\t\tdate);\r\n\tparent.appendChild(p1);\r\n\r\n\tif(opts.showPassingPeriods) {\r\n\t\tvar lunchPassing = document.createElement(\"div\");\r\n\t\tlunchPassing.classList.add(\"period\");\r\n\t\tcreatePeriod(lunchPassing,\"\",end1,start2,date);\r\n\t\tparent.appendChild(lunchPassing);\r\n\t}\r\n\r\n\tvar p2 = document.createElement(\"div\");\r\n\tp2.classList.add(\"period\");\r\n\tvar w2 = document.createElement(\"div\");\r\n\tw2.classList.add(\"periodWrapper\");\r\n\tcreatePeriod(\r\n\t\t\tp2,\r\n\t\t\tname.substring(name.indexOf(\"|\")+1),\r\n\t\t\tstart2,\r\n\t\t\tend2,\r\n\t\t\tdate);\r\n\tparent.appendChild(p2);\r\n}\r\n\r\n/**\r\n * Highlights given date/time on the schedule; defaults to now if none is given\r\n */\r\nfunction setHighlightedPeriod(time) {\r\n\t//set default time argument\r\n\tif(!time) time = Date.now();\r\n\r\n\t//set date based on time (for finding day to highlight)\r\n\tvar date = new Date(time);\r\n\tdate.setHours(0,0,0,0);\r\n\r\n\t//clear previous highlighted day/periods\r\n\t//TODO: maybe it would be better to not clear highlights when nothing needs to be changed.\r\n\tvar prevDay = document.getElementById(\"today\");\r\n\tvar prevPeriods = [];\r\n\tif(prevDay){\r\n\t\t//clear previous highlighted periods\r\n\t\tprevPeriods = Array.prototype.slice.call(prevDay.getElementsByClassName(\"now\")); //get copy of array, not reference to it (needed to check for period changes later)\r\n\r\n\t\tfor(var i=prevPeriods.length-1;i>=0;i--){\r\n\t\t\tvar prevPeriod = prevPeriods[i];\r\n\t\t\tprevPeriod.classList.remove(\"now\");\r\n\t\t\t//remove period length\r\n\t\t\tvar periodLength = prevPeriod.getElementsByClassName(\"periodLength\")[0];\r\n\t\t\tif(periodLength) prevPeriod.removeChild(periodLength);\r\n\t\t}\r\n\t\t\r\n\t\t//clear previous highlighted day\r\n\t\t//needs to be done after getting prevPeriods, or else prevDay no longer points anywhere\r\n\t\tprevDay.id = \"\";\r\n\t}\r\n\r\n\t//set new highlighted day/period\r\n\tvar days = document.getElementById(\"schedule\").rows[0].cells;\r\n\tfor(var d=0;d<days.length;d++){\r\n\t\tvar day = days[d];\r\n\t\tif(date.valueOf() == day.date){ //test if date should be highlighted\r\n\t\t\t//set new highlighted day\r\n\t\t\tday.id = \"today\";\r\n\r\n\t\t\t//set new highlighted periods\r\n\t\t\tvar periods = day.getElementsByClassName(\"periodWrapper\");\r\n\t\t\tfor(var p=0;p<periods.length;p++){\r\n\t\t\t\tvar period = periods[p];\r\n\t\t\t\tif(time-period.start>=0 && time-period.end<0){ //test if period should be highlighted\r\n\t\t\t\t\tperiod.classList.add(\"now\");\r\n\t\t\t\t\t//add period length if it fits\r\n\t\t\t\t\tif((period.end-period.start)/60000>=40){\r\n\t\t\t\t\t\tvar length = (period.end - time) / 60000;\r\n\t\t\t\t\t\tperiod.innerHTML += \"<div class=\\\"periodLength\\\">\" +\r\n\t\t\t\t\t\t\t\t(length>1 ?\r\n\t\t\t\t\t\t\t\t\tMath.round(length) + \" min. left</div>\" :\r\n\t\t\t\t\t\t\t\t\tMath.round(length*60) + \" sec. left</div>\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif(opts.enablePeriodNotifications) {\r\n\t\tvar currPeriods = Array.prototype.slice.call(document.getElementsByClassName(\"now\")); //needs to be an array and not an HTML\r\n\r\n\t\tvar diff1 = currPeriods.diff(prevPeriods);\r\n\t\tvar diff2 = prevPeriods.diff(currPeriods);\r\n\r\n\t\tfor(var i=0; i<diff1.length; i++) {\r\n\t\t\tvar name = currPeriods[i].periodName;\r\n\t\t\tif(name && !hasFocus) sendNotification(name + \" has started.\", opts.notificationDuration);\r\n\t\t}\r\n\t\tfor(var i=0; i<diff2.length; i++) {\r\n\t\t\tvar name = prevPeriods[i].periodName;\r\n\t\t\tif(name && !hasFocus) sendNotification(name + \" has ended.\", opts.notificationDuration);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Updates schedule to display as it would on the given date/time; defaults to now if none is given.\r\n * Also updates\r\n */\r\nfunction updateSchedule(time,force) {\r\n\tsetDisplayDate(time,force);\r\n\tsetHighlightedPeriod();\r\n}\r\nexports.updateSchedule = updateSchedule;\r\n\r\n/**\r\n * Creates a desktop notification with the given text for a title and removes it after the given duration in seconds.\r\n * A duration of 0 or less will disable auto-closing the notification.\r\n */\r\nfunction sendNotification(text, duration) {\r\n\tif(\"Notification\" in window) { //check that browser supports notifications\r\n\t\tvar notification = new Notification(text);\r\n\t\tif(duration > 0)\r\n\t\t\tsetTimeout(function() {notification.close();}, duration*1000);\r\n\t}\r\n}\r\n","var dateUtil = require(\"./dateUtil.js\");\r\n\r\n\r\nvar urlParams; //object with GET variables as properties and their respective values as values\r\nvar viewType;\r\n\r\n\r\n/**\r\n * Gets GET variables from URL and sets them as properties of the urlParams object.\r\n * Then updates the state of the current history entry with the appropriate week.\r\n */\r\n\r\n/**\r\n * Adds appropriate event listeners to items in the schedule title.\r\n */\r\nexports.init = function() {\r\n\t//decode GET vars in URL\r\n\tupdateUrlParams();\r\n\t\r\n\t//update history state\r\n\twindow.history.replaceState( getDateFromUrlParams() );\r\n\t\r\n\tdocument.getElementById(\"header\").addEventListener(\"click\", setTitleTitle);\r\n\tdocument.getElementById(\"leftArrow\").addEventListener(\"click\", goPrev);\r\n\tdocument.getElementById(\"rightArrow\").addEventListener(\"click\", goNext);\r\n\r\n\tdocument.getElementById(\"refresh\").addEventListener(\"click\", function(){ updateSchedule(null,true); });\r\n\r\n\tsetTitleTitle();\r\n};\r\n\r\nexports.setViewType = function(type) {\r\n\tviewType = type;\r\n}\r\n\r\nvar viewTypes = exports.viewTypes = {\r\n\tDAY: \"day\",\r\n\tWEEK: \"week\"\r\n}\r\n\r\n\r\n/**\r\n * Event listener for navigating through history.\r\n * (onload event will not fire when navigating through history items pushed by history.pushState, because the page does not reload)\r\n */\r\naddEventListener(\"popstate\", function(event) {\r\n\tupdateUrlParams();\r\n\tupdateSchedule(event.state);\r\n});\r\n\r\n/**\r\n * Sets the title of the title to a random line from the title titles list\r\n */\r\nfunction setTitleTitle() {\r\n\tvar titles = document.getElementById(\"titleTitles\").textContent.split(\"\\n\");\r\n\tdocument.getElementById(\"title\").title=titles[Math.floor(Math.random()*titles.length)];\r\n}\r\n\r\n/**\r\n * Updates urlParams object based on the GET variables in the URL.\r\n * (variables as properties and values as values)\r\n */\r\nfunction updateUrlParams() {\r\n\turlParams = {};\r\n\t\r\n\tvar match,\r\n\t\tpl = /(?!^)\\+/g,  //regex for replacing non-leading + with space\r\n\t\tsearch = /([^&=]+)=?([^&]*)/g,\r\n\t\tdecode = function (s) { return decodeURIComponent(s.replace(pl, \" \")); },\r\n\t\tquery = location.search.substring(1);\r\n\t\r\n\twhile (match = search.exec(query))\r\n\t\turlParams[decode(match[1])] = decode(match[2]);\r\n}\r\n\r\n/**\r\n * Returns a Date object based on the current urlParams (GET variables in the URL).\r\n * If any part of the date is not specified, defaults to the current date/month/year.\r\n * If in week view, uses the Monday of the week instead of the day.\r\n */\r\nfunction getDateFromUrlParams() {\r\n\tvar date = new Date();\r\n\t\r\n\tif(urlParams[\"y\"]>0) date.setFullYear(urlParams[\"y\"]);\r\n\tif(urlParams[\"m\"]>0) date.setMonth(urlParams[\"m\"]-1);\r\n\tif(urlParams[\"d\"]>0) date.setDate(urlParams[\"d\"]);\r\n\t\r\n\tif(viewType == viewTypes.WEEK) date = dateUtil.getMonday(date);\r\n\t\r\n\treturn date;\r\n}\r\nexports.getDateFromUrlParams = getDateFromUrlParams; //TODO: remove web of dependencies\r\n\r\n/**\r\n * Navigates schedule to previous date.\r\n */\r\nfunction goPrev() {\r\n\tvar date = new Date(displayDate);\r\n\tdate.setDate(date.getDate() - (viewType == viewTypes.DAY ? 1 : 7));\r\n\tupdateSchedule(date);\r\n\t\r\n\tupdateSearch(date);\r\n}\r\n\r\n/**\r\n * Navigates schedule to next date.\r\n */\r\nfunction goNext() {\r\n\tvar date = new Date(displayDate);\r\n\tdate.setDate(date.getDate() + (viewType == viewTypes.DAY ? 1 : 7));\r\n\tupdateSchedule(date);\r\n\t\r\n\tupdateSearch(date);\r\n}\r\n\r\n/**\r\n * Navigates schedule to current date.\r\n */\r\nfunction goCurr() {\r\n\tvar date = new Date();\r\n\tupdateSchedule(date);\r\n\r\n\tupdateSearch(date);\r\n}\r\n\r\n/**\r\n * Updates GET variables and urlParams to reflect date in week and pushes corresponding history state.\r\n */\r\nfunction updateSearch(week, noHistory) {\r\n\tvar curr = new Date();\r\n\t\r\n\tif(viewType == viewTypes.WEEK) curr = dateUtil.getMonday(curr);\r\n\t\r\n\tif(week.getDate() != curr.getDate()) {\r\n\t\turlParams[\"m\"] = week.getMonth()+1;\r\n\t\turlParams[\"d\"] = week.getDate();\r\n\t} else {\r\n\t\tdelete urlParams[\"m\"];\r\n\t\tdelete urlParams[\"d\"];\r\n\t}\r\n\tif(week.getYear() != curr.getYear()) urlParams[\"y\"] = week.getFullYear().toString().substr(-2);\r\n\telse delete urlParams[\"y\"];\r\n\t\r\n\tvar search = \"?\";\r\n\tfor(var param in urlParams) search += param + \"=\" + urlParams[param] + \"&\";\r\n\tsearch = search.slice(0,-1);\r\n\t\r\n\thistory.pushState(week, document.title, location.protocol + \"//\" + location.host + location.pathname + search + location.hash);\r\n}\r\n","var mobile = require(\"./mobile.js\");\r\nvar nav = require(\"./nav.js\");\r\nvar schedule = require(\"./schedule.js\");\r\n\r\nvar isMobile = mobile.isMobile;\r\n\r\n\r\nvar options = {};\r\nexports.options = options;\r\n\r\nexports.init = function() {\r\n\tdownload(\"options.json\", createOptions, displayOptionsError);\r\n};\r\n\r\n/**\r\n * Expands the options div and changes the options arrow to point down and to the right.\r\n */\r\nfunction expandOptions() {\r\n\tdocument.getElementById(\"options\").classList.add(\"expanded\");\r\n\tdocument.getElementById(\"optionsArrow\").innerHTML = \"&#8600;\";\r\n}\r\n/**\r\n * Contracts the options div and changes the options arrow to point up and to the left.\r\n */\r\nfunction contractOptions() {\r\n\tdocument.getElementById(\"options\").classList.remove(\"expanded\");\r\n\tdocument.getElementById(\"optionsArrow\").innerHTML = \"&#8598;\";\r\n}\r\n/**\r\n * Toggles the options div between extended and contracted and updates options arrow accordingly.\r\n */\r\nfunction toggleOptions() {\r\n\tif(document.getElementById(\"options\").classList.contains(\"expanded\"))\r\n\t\tcontractOptions();\r\n\telse expandOptions();\r\n\r\n}\r\n\r\n/**\r\n * Initializes automatic option saving and sets options to previously-saved values, if any.\r\n * If no previous saved value exists, sets current (default) value as saved value.\r\n */\r\nfunction initOptions() {\r\n\tvar opt = document.getElementById(\"options\");\r\n\topt.addEventListener(\"mouseover\", expandOptions);\r\n\topt.addEventListener(\"mouseout\", contractOptions);\r\n\r\n\tif(isMobile) opt.classList.add(\"mobile\");\r\n\r\n\tdocument.getElementById(\"optionsArrow\").addEventListener(\"click\", toggleOptions);\r\n\r\n\tvar inputs = opt.getElementsByTagName(\"input\");\r\n\r\n\tif(localStorage.updateScheduleInterval) {\r\n\t\t//rename key\r\n\t\tlocalStorage.activeUpdateInterval=localStorage.updateScheduleInterval;\r\n\t\tlocalStorage.removeItem(\"updateScheduleInterval\");\r\n\t}\r\n\r\n\tfor(var i=0; i<inputs.length; i++)\r\n\t{\r\n\t\tvar input = inputs[i];\r\n\t\t//special cases because localStorage saves values as strings\r\n\t\tif(input.type==\"checkbox\") {\t\t\t\t\t\t\t\t\t\t\t//booleans\r\n\t\t\tinput.addEventListener(\"change\", function(event) {\r\n\t\t\t\toptions[event.target.name] = localStorage[event.target.name] = event.target.checked;\r\n\t\t\t});\r\n\r\n\t\t\tif(localStorage[input.name]) options[input.name] = input.checked = localStorage[input.name]==\"true\";\r\n\t\t\telse options[input.name] = localStorage[input.name] = input.checked;\r\n\t\t}\r\n\t\telse if(input.type==\"number\") {\t\t\t\t\t\t\t\t\t\t//numbers\r\n\t\t\tinput.addEventListener(\"change\", function(event) {\r\n\t\t\t\toptions[event.target.name] = parseInt(localStorage[event.target.name] = event.target.value);\r\n\t\t\t});\r\n\r\n\t\t\tif(localStorage[input.name]) options[input.name] = parseInt(input.value = localStorage[input.name]);\r\n\t\t\telse options[input.name] = parseInt(localStorage[input.name] = input.value);\r\n\t\t}\r\n\t\telse {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//strings\r\n\t\t\tinput.addEventListener(\"change\", function(event) {\r\n\t\t\t\toptions[event.target.name] = localStorage[event.target.name] = event.target.value;\r\n\t\t\t});\r\n\r\n\t\t\tif(localStorage[input.name]) options[input.name] = input.value = localStorage[input.name];\r\n\t\t\telse options[input.name] = localStorage[input.name] = input.value;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Creates options in the options div.\r\n */\r\nfunction createOptions(data) {\r\n\t// just assume the file has everything for now\r\n\tJSON.parse(data).sections.forEach(function(section) {\r\n\t\tif(!section.hasOwnProperty(\"platforms\") ||\r\n\t\t\t((isMobile && section.platforms.indexOf(\"mobile\") >= 0) || !isMobile)) {\r\n\t\t\tcreateOptionSection(section);\r\n\t\t}\r\n\t});\r\n\r\n\tinitOptions();\r\n\tattachOptionActions();\r\n\r\n\tschedule.updateSchedule(null, true);\r\n}\r\n\r\n/**\r\n * Displays error about retrieving schedule.\r\n */\r\nfunction displayOptionsError(timeout, status) {\r\n\tschedule.updateSchedule();\r\n\t\r\n\tif(timeout) {\r\n\t\twarn(\"Retrieval of options.json timed out!\");\r\n\t} else {\r\n\t\twarn(\"Something went wrong while retrieving options.json!\");\r\n\t}\r\n}\r\n\r\n/**\r\n * Create and insert options section.\r\n */\r\nfunction createOptionSection(section) {\r\n\tcreateOptionSectionTitle(section);\r\n\tsection.options.forEach(function(option) {\r\n\t\tif(!option.hasOwnProperty(\"platforms\") ||\r\n\t\t   ((isMobile && option.platforms.indexOf(\"mobile\") >= 0) || !isMobile)) {\r\n\t\t\tcreateOption(option);\r\n\t\t}\r\n\t});\r\n}\r\n\r\n/**\r\n * Create and insert options section title.\r\n */\r\nfunction createOptionSectionTitle(section) {\r\n\tvar tr = document.createElement(\"tr\");\r\n\tvar th = document.createElement(\"th\");\r\n\tth.colspan = 2;\r\n\tif(section.hasOwnProperty(\"tooltip\")) {\r\n\t\tvar span = document.createElement(\"span\");\r\n\t\tspan.title = section[\"tooltip\"];\r\n\t\tspan.innerHTML = section.name + '<sup class=\"tooltipIndicator\">?</sup>';\r\n\t\tth.appendChild(span);\r\n\t} else {\r\n\t\tth.textContent = section.name;\r\n\t}\r\n\ttr.appendChild(th);\r\n\tdocument.getElementById(\"optionsContent\").appendChild(tr);\r\n}\r\n\r\n/**\r\n * Create and insert option into options.\r\n */\r\nfunction createOption(option) {\r\n\tvar tr = document.createElement(\"tr\");\r\n\tvar tddesc = document.createElement(\"td\");\r\n\tvar tdinput = document.createElement(\"td\");\r\n\tif(option.hasOwnProperty(\"tooltip\")) {\r\n\t\tvar span = document.createElement(\"span\");\r\n\t\tspan.title = option.tooltip;\r\n\t\tspan.innerHTML = option.description + '<sup class=\"tooltipIndicator\">?</sup>:';\r\n\t\ttddesc.appendChild(span);\r\n\t} else {\r\n\t\ttddesc.textContent = option.description + \":\";\r\n\t}\r\n\tvar input = document.createElement(\"input\");\r\n\tinput.name = option.name;\r\n\tinput.type = option.type;\r\n\tvar defaultValue = (isMobile && option.hasOwnProperty(\"mobileDefault\")) ? option.mobileDefault : option.default; //choose desktop or mobile default value\r\n\tif(input.type == \"number\") {\r\n\t\tinput.min = 0; //may as well keep this here until any options can take negative\r\n\t\tinput.value = defaultValue;\r\n\t} else if(input.type == \"checkbox\") {\r\n\t\tif(defaultValue) input.checked = \"checked\";\r\n\t}\r\n\ttdinput.appendChild(input);\r\n\ttr.appendChild(tddesc);\r\n\ttr.appendChild(tdinput);\r\n\tdocument.getElementById(\"optionsContent\").appendChild(tr);\r\n}\r\n\r\n/**\r\n * Creates event listeners for option-specific actions on option change and applies option-specific actions on page load.\r\n */\r\nfunction attachOptionActions() {\r\n\tschedule.updateUpdateInterval();\r\n\tdocument.getElementsByName(\"activeUpdateInterval\")[0].addEventListener(\"change\", function(event) {\r\n\t\tschedule.updateUpdateInterval();\r\n\t});\r\n\tdocument.getElementsByName(\"showPassingPeriods\")[0].addEventListener(\"change\", function(event) {\r\n\t\tschedule.updateSchedule(null,true);\r\n\t});\r\n\r\n\tdocument.getElementsByName(\"enablePeriodNotifications\")[0].addEventListener(\"change\", function(event) {\r\n\t\tif(options.enablePeriodNotifications) {\r\n\t\t\tvar permission = Notification.permission;\r\n\t\t\tif(!(\"Notification\" in window)) {\r\n\t\t\t\talert(\"This browser does not support desktop notifications.\");\r\n\t\t\t} else if(permission == \"denied\") {\r\n\t\t\t\talert(\"Please allow desktop notifications for this site to enable this feature.\");\r\n\t\t\t} else if(permission == \"default\") {\r\n\t\t\t\tNotification.requestPermission();\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\tdocument.body.classList.add(options.enableDayView ? \"day\" : \"week\");\r\n\tnav.setViewType(options.enableDayView ? nav.viewTypes.DAY : nav.viewTypes.WEEK);\r\n\tdocument.getElementsByName(\"enableDayView\")[0].addEventListener(\"change\", function(event) {\r\n\t\tschedule.updateSchedule(null, true);\r\n\t\t\r\n\t\tdocument.body.classList.remove(\"week\");\r\n\t\tdocument.body.classList.remove(\"day\");\r\n\t\t\r\n\t\tnav.setViewType(options.enableDayView ? nav.viewTypes.DAY : nav.viewTypes.WEEK);\r\n\t\t\r\n\t\tnav.setViewType(options.enableDayView ? \"day\" : \"week\");\r\n\t\t\r\n\t\tscrollTo(0,0); //scroll back to top-left corner\r\n\t});\r\n\r\n\tif(!isMobile) {\r\n\t\tdocument.addEventListener(\"keydown\", function(event) {\r\n\t\t\tswitch (event.keyCode){\r\n\t\t\t\tcase 116 : //F5\r\n\t\t\t\t\tif(options.interceptF5){\r\n\t\t\t\t\t\t//enabled\r\n\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\tschedule.updateSchedule();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 82 : //R key\r\n\t\t\t\t\tif(options.interceptCtrlR && (event.ctrlKey||event.metaKey)){\r\n\t\t\t\t\t\t//enabled and control/cmd (meta)\r\n\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\tschedule.updateSchedule();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 37 : //Left arrow\r\n\t\t\t\t\tgoPrev();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 39 : //Right arrow\r\n\t\t\t\t\tgoNext();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 40 : //Down arrow\r\n\t\t\t\t\tgoCurr();\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tsetDoge(options.enableDoge);\r\n\t\tdocument.getElementsByName(\"enableDoge\")[0].addEventListener(\"change\", function(event) {\r\n\t\t\tsetDoge(event.target.checked);\r\n\t\t});\r\n\t}\r\n}\r\n\r\n/**\r\n * Retrieve file data via XMLHttpRequest.\r\n *\r\n * cb is for successful retrieval and takes a String as a parameter.\r\n * errcb is for an error on retrieval and takes:\r\n *    1. a boolean representing whether or not the error was a timeout.\r\n *    2. an integer representing the status of the response (this is null on timeout).\r\n */\r\nfunction download(url, cb, errcb) {\r\n\tvar xmlhttp = new XMLHttpRequest();\r\n\txmlhttp.open(\"GET\", url, true);\r\n\txmlhttp.onreadystatechange = function() {\r\n\t\tif(xmlhttp.readyState == 4) {\r\n\t\t\tif(xmlhttp.status == 200) {\r\n\t\t\t\tcb(xmlhttp.responseText);\r\n\t\t\t} else if(errcb) {\r\n\t\t\t\terrcb(false, xmlhttp.status);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\txmlhttp.ontimeout = function() {\r\n\t\terrcb(true, null);\r\n\t};\r\n\txmlhttp.send();\r\n}\r\n","\r\n/**\r\n * Function to detect whether the page is being displayed on a mobile device.\r\n * Currently checks if the useragent/vendor matches a regex string for mobile phones.\r\n */\r\nfunction isMobile() {\r\n\tvar a = navigator.userAgent || navigator.vendor || window.opera;\r\n\tif(window.innerWidth <= 800 && window.innerHeight <= 600) return true;\r\n\treturn /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0, 4));\r\n}\r\n\r\n\r\nexports.init = function() {\r\n\tvar mobile = exports.isMobile = isMobile();\r\n\tif(mobile) {\r\n\t\tvar meta = document.createElement(\"meta\");\r\n\t\tmeta.name = \"viewport\";\r\n\t\tmeta.content = 'user-scalable=no, initial-scale=1.0, maximum-scale=1.0';\r\n\t\tdocument.getElementsByTagName(\"head\")[0].appendChild(meta);\r\n\t\tdocument.getElementsByTagName(\"body\")[0].class = \"mobile\";\r\n\t}\r\n};\r\n\r\n"]}